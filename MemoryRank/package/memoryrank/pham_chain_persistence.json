[
  {
    "index": 0,
    "timestamp": 1769617056.733212,
    "data": {
      "name": "GENESIS"
    },
    "hash": "0"
  },
  {
    "index": 1,
    "timestamp": 1769617056.733214,
    "data": {
      "title": "persistence.py",
      "author": "GNJz",
      "timestamp": "2026-01-29 03:17:36",
      "hash": "3c1e2aa8f511b8239d05f9a68c07fe1764896186d9b747bb937816eb14b2817b",
      "cid": "QmW9LJa62pb8w5N2D7qHAXgeafZBxJXsHJMfJ3x1VCATdN",
      "description": "MemoryRank Persistence Layer v1.0 - JSON/NumPy NPZ 영속성 지원",
      "score": 0.9997,
      "label": "A_HIGH",
      "signals": {
        "byte": 1.0,
        "text": 1.0,
        "ast": 0.9991189427312775,
        "exec": 0.0
      },
      "exec_output": "",
      "raw_bytes": "2222224d656d6f727952616e6b2050657273697374656e6365204c617965722076312e300a0aec9881ec868dec84b120eba088ec9db4ec96b4202d20eab8b0ec96b520eab7b8eb9e98ed9484ec998020eb9eaded81ac20ebb2a1ed84b0eba5bc20ec9881eab5ac20eca080ec9ea5ed95a9eb8b88eb8ba42e0aeca780ec9b9020ed8faceba7b73a204a534f4e2c204e756d507920282e6e707a290a0aec9db420eba088ec9db4ec96b4eab08020ec9e88ec96b4ec95bc2022ec9ea5eab8b020eab8b0ec96b522ec9db4eb9dbceb8a9420ed919ced9884ec9db420eca095ed9995ed95b4eca791eb8b88eb8ba42e0a2d20ed9599ec8ab5eb909c20eab8b0ec96b520eca491ec9a94eb8f84eab08020ec9881eab5ac20ebb3b4eca1b4eb90a80a2d20eab7b8eb9e98ed948420eab5aceca1b0eab08020ed9484eba19cec84b8ec8aa420eca285eba38c20ed9b84ec9790eb8f8420ec9ca0eca780eb90a80a2222220a0a66726f6d205f5f6675747572655f5f20696d706f727420616e6e6f746174696f6e730a0a696d706f7274206a736f6e0a66726f6d20706174686c696220696d706f727420506174680a66726f6d20747970696e6720696d706f727420545950455f434845434b494e472c20446963742c204c6973742c205475706c652c204f7074696f6e616c2c20416e790a0a696d706f7274206e756d7079206173206e700a0a696620545950455f434845434b494e473a0a2020202066726f6d202e6d656d6f727972616e6b5f656e67696e6520696d706f7274204d656d6f727952616e6b456e67696e652c204d656d6f72794e6f6465417474726962757465730a0a0a636c617373204d656d6f727952616e6b50657273697374656e63653a0a202020202222224d656d6f727952616e6b20ec9794eca784ec9d9820ec9881ec868dec84b120eab480eba6acec9e900a202020200a20202020ec82acec9aa920ec9888ec8b9c3a0a20202020202020203e3e3e20656e67696e65203d204d656d6f727952616e6b456e67696e6528290a20202020202020203e3e3e20656e67696e652e6275696c645f67726170682865646765732c2061747472696275746573290a20202020202020203e3e3e20656e67696e652e63616c63756c6174655f696d706f7274616e636528290a20202020202020203e3e3e200a20202020202020203e3e3e202320eca080ec9ea50a20202020202020203e3e3e2070657273697374656e6365203d204d656d6f727952616e6b50657273697374656e636528656e67696e65290a20202020202020203e3e3e2070657273697374656e63652e736176655f6a736f6e28226d656d6f72795f67726170682e6a736f6e22290a20202020202020203e3e3e200a20202020202020203e3e3e202320ebb688eb9facec98a4eab8b00a20202020202020203e3e3e206e65775f656e67696e65203d204d656d6f727952616e6b456e67696e6528290a20202020202020203e3e3e2070657273697374656e6365203d204d656d6f727952616e6b50657273697374656e6365286e65775f656e67696e65290a20202020202020203e3e3e2070657273697374656e63652e6c6f61645f6a736f6e28226d656d6f72795f67726170682e6a736f6e22290a202020202222220a202020200a20202020646566205f5f696e69745f5f2873656c662c20656e67696e653a20224d656d6f727952616e6b456e67696e6522293a0a202020202020202073656c662e656e67696e65203d20656e67696e650a202020200a2020202023202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a2020202023204a534f4e20eca080ec9ea52feba19ceb939c2028ec9db4ec8b9dec84b120ec9ab0ec84a0290a2020202023202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a2020202064656620736176655f6a736f6e2873656c662c20706174683a207374722c20696e64656e743a20696e74203d203229202d3e20446963745b7374722c20696e745d3a0a2020202020202020222222eab7b8eb9e98ed9484ec998020eb9eaded81ac20ebb2a1ed84b0eba5bc204a534f4eec9cbceba19c20eca080ec9ea50a20202020202020200a2020202020202020417267733a0a202020202020202020202020706174683a20eca080ec9ea520eab2bdeba19c0a202020202020202020202020696e64656e743a204a534f4e20eb93a4ec97acec93b0eab8b00a2020202020202020202020200a202020202020202052657475726e733a0a2020202020202020202020207b226e6f646573223a20eb85b8eb939c20ec88982c20226564676573223a20ec97a3eca78020ec88987d0a20202020202020202222220a2020202020202020656e67696e65203d2073656c662e656e67696e650a20202020202020200a20202020202020202320eb85b8eb939c20ebaaa9eba19d0a20202020202020206e6f646573203d206c69737428656e67696e652e5f696e6465785f746f5f6964290a20202020202020200a20202020202020202320eca084ec9db420ed9689eba0acec9790ec849c20ec97a3eca78020ecb694ecb69c0a20202020202020206564676573203d205b5d0a2020202020202020696620656e67696e652e5f4d206973206e6f74204e6f6e653a0a2020202020202020202020206e203d20656e67696e652e5f4d2e73686170655b305d0a202020202020202020202020666f72206a20696e2072616e6765286e293a202023207372630a20202020202020202020202020202020666f72206920696e2072616e6765286e293a202023206473740a2020202020202020202020202020202020202020776569676874203d20656e67696e652e5f4d5b692c206a5d0a2020202020202020202020202020202020202020696620776569676874203e20303a0a20202020202020202020202020202020202020202020202065646765732e617070656e64287b0a2020202020202020202020202020202020202020202020202020202022737263223a20656e67696e652e5f696e6465785f746f5f69645b6a5d2c0a2020202020202020202020202020202020202020202020202020202022647374223a20656e67696e652e5f696e6465785f746f5f69645b695d2c0a2020202020202020202020202020202020202020202020202020202022776569676874223a20666c6f617428776569676874292c0a2020202020202020202020202020202020202020202020207d290a20202020202020200a20202020202020202320706572736f6e616c697a6174696f6e20766563746f720a2020202020202020706572736f6e616c697a6174696f6e203d204e6f6e650a2020202020202020696620656e67696e652e5f76206973206e6f74204e6f6e653a0a202020202020202020202020706572736f6e616c697a6174696f6e203d207b0a202020202020202020202020202020206e69643a20666c6f617428656e67696e652e5f765b695d290a20202020202020202020202020202020666f7220692c206e696420696e20656e756d657261746528656e67696e652e5f696e6465785f746f5f6964290a2020202020202020202020207d0a20202020202020200a2020202020202020232072616e6b20766563746f720a202020202020202072616e6b73203d204e6f6e650a2020202020202020696620656e67696e652e5f72206973206e6f74204e6f6e653a0a20202020202020202020202072616e6b73203d207b0a202020202020202020202020202020206e69643a20666c6f617428656e67696e652e5f725b695d290a20202020202020202020202020202020666f7220692c206e696420696e20656e756d657261746528656e67696e652e5f696e6465785f746f5f6964290a2020202020202020202020207d0a20202020202020200a202020202020202064617461203d207b0a2020202020202020202020202276657273696f6e223a2022312e302e30222c0a20202020202020202020202022656e67696e65223a20224d656d6f727952616e6b456e67696e65222c0a202020202020202020202020226e6f64655f636f756e74223a206c656e286e6f646573292c0a20202020202020202020202022656467655f636f756e74223a206c656e286564676573292c0a202020202020202020202020226e6f646573223a206e6f6465732c0a202020202020202020202020226564676573223a2065646765732c0a20202020202020202020202022706572736f6e616c697a6174696f6e223a20706572736f6e616c697a6174696f6e2c0a2020202020202020202020202272616e6b73223a2072616e6b732c0a20202020202020207d0a20202020202020200a2020202020202020506174682870617468292e77726974655f74657874286a736f6e2e64756d707328646174612c20696e64656e743d696e64656e742c20656e737572655f61736369693d46616c736529290a202020202020202072657475726e207b226e6f646573223a206c656e286e6f646573292c20226564676573223a206c656e286564676573297d0a202020200a20202020646566206c6f61645f6a736f6e2873656c662c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a20202020202020202222224a534f4eec9790ec849c20eab7b8eb9e98ed9484ec998020eb9eaded81ac20ebb2a1ed84b020eba19ceb939c0a20202020202020200a2020202020202020417267733a0a202020202020202020202020706174683a20ed8c8cec9dbc20eab2bdeba19c0a2020202020202020202020200a202020202020202052657475726e733a0a2020202020202020202020207b226e6f646573223a20eb85b8eb939c20ec88982c20226564676573223a20ec97a3eca78020ec88987d0a20202020202020202222220a202020202020202064617461203d206a736f6e2e6c6f61647328506174682870617468292e726561645f746578742829290a2020202020202020656e67696e65203d2073656c662e656e67696e650a20202020202020200a20202020202020206e6f646573203d20646174612e67657428226e6f646573222c205b5d290a202020202020202065646765735f64617461203d20646174612e67657428226564676573222c205b5d290a2020202020202020706572736f6e616c697a6174696f6e203d20646174612e6765742822706572736f6e616c697a6174696f6e22290a202020202020202072616e6b73203d20646174612e676574282272616e6b7322290a20202020202020200a20202020202020206e203d206c656e286e6f646573290a20202020202020200a20202020202020202320eb85b8eb939c20eba7a4ed959120ebb3b5ec9b900a2020202020202020656e67696e652e5f696e6465785f746f5f6964203d206c697374286e6f646573290a2020202020202020656e67696e652e5f69645f746f5f696e646578203d207b6e69643a206920666f7220692c206e696420696e20656e756d6572617465286e6f646573297d0a20202020202020200a20202020202020202320eca084ec9db420ed9689eba0ac20ebb3b5ec9b900a20202020202020206966206e203e20303a0a202020202020202020202020656e67696e652e5f4d203d206e702e7a65726f7328286e2c206e292c2064747970653d666c6f6174290a202020202020202020202020666f72206564676520696e2065646765735f646174613a0a202020202020202020202020202020207372632c206473742c2077203d20656467655b22737263225d2c20656467655b22647374225d2c20656467655b22776569676874225d0a2020202020202020202020202020202069662073726320696e20656e67696e652e5f69645f746f5f696e64657820616e642064737420696e20656e67696e652e5f69645f746f5f696e6465783a0a20202020202020202020202020202020202020206a203d20656e67696e652e5f69645f746f5f696e6465785b7372635d0a202020202020202020202020202020202020202069203d20656e67696e652e5f69645f746f5f696e6465785b6473745d0a2020202020202020202020202020202020202020656e67696e652e5f4d5b692c206a5d203d20770a2020202020202020656c73653a0a202020202020202020202020656e67696e652e5f4d203d204e6f6e650a20202020202020200a20202020202020202320706572736f6e616c697a6174696f6e20766563746f7220ebb3b5ec9b900a2020202020202020696620706572736f6e616c697a6174696f6e20616e64206e203e20303a0a202020202020202020202020656e67696e652e5f76203d206e702e7a65726f73286e2c2064747970653d666c6f6174290a202020202020202020202020666f72206e69642c2076616c20696e20706572736f6e616c697a6174696f6e2e6974656d7328293a0a202020202020202020202020202020206966206e696420696e20656e67696e652e5f69645f746f5f696e6465783a0a2020202020202020202020202020202020202020656e67696e652e5f765b656e67696e652e5f69645f746f5f696e6465785b6e69645d5d203d2076616c0a2020202020202020656c73653a0a202020202020202020202020656e67696e652e5f76203d206e702e6f6e6573286e2c2064747970653d666c6f617429202f206e206966206e203e203020656c7365204e6f6e650a20202020202020200a2020202020202020232072616e6b20766563746f7220ebb3b5ec9b900a202020202020202069662072616e6b7320616e64206e203e20303a0a202020202020202020202020656e67696e652e5f72203d206e702e7a65726f73286e2c2064747970653d666c6f6174290a202020202020202020202020666f72206e69642c2076616c20696e2072616e6b732e6974656d7328293a0a202020202020202020202020202020206966206e696420696e20656e67696e652e5f69645f746f5f696e6465783a0a2020202020202020202020202020202020202020656e67696e652e5f725b656e67696e652e5f69645f746f5f696e6465785b6e69645d5d203d2076616c0a2020202020202020656c73653a0a202020202020202020202020656e67696e652e5f72203d204e6f6e650a20202020202020200a202020202020202072657475726e207b226e6f646573223a206e2c20226564676573223a206c656e2865646765735f64617461297d0a202020200a2020202023202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a2020202023204e756d507920eca080ec9ea52feba19ceb939c2028ec84b1eb8aa520ec9ab0ec84a0290a2020202023202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a2020202064656620736176655f6e707a2873656c662c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a2020202020202020222222eab7b8eb9e98ed9484ec998020eb9eaded81ac20ebb2a1ed84b0eba5bc204e756d507920ec9595ecb69520ed8c8cec9dbceba19c20eca080ec9ea50a20202020202020200a2020202020202020eb8c80ec9aa9eb9f8920eab7b8eb9e98ed9484ec979020eca081ed95a920284a534f4eebb3b4eb8ba420ebb9a0eba684290a20202020202020200a2020202020202020417267733a0a202020202020202020202020706174683a20eca080ec9ea520eab2bdeba19c20282e6e707a290a2020202020202020202020200a202020202020202052657475726e733a0a2020202020202020202020207b226e6f646573223a20eb85b8eb939c20ec88987d0a20202020202020202222220a2020202020202020656e67696e65203d2073656c662e656e67696e650a20202020202020200a20202020202020202320eb85b8eb939c20ebaaa9eba19dec9d84204a534f4e20ebacb8ec9e90ec97b4eba19c0a20202020202020206e6f6465735f6a736f6e203d206a736f6e2e64756d707328656e67696e652e5f696e6465785f746f5f69642c20656e737572655f61736369693d46616c7365290a20202020202020200a2020202020202020736176655f64696374203d207b0a202020202020202020202020226e6f6465735f6a736f6e223a206e702e6172726179285b6e6f6465735f6a736f6e5d292c0a20202020202020207d0a20202020202020200a2020202020202020696620656e67696e652e5f4d206973206e6f74204e6f6e653a0a202020202020202020202020736176655f646963745b224d225d203d20656e67696e652e5f4d0a2020202020202020696620656e67696e652e5f76206973206e6f74204e6f6e653a0a202020202020202020202020736176655f646963745b2276225d203d20656e67696e652e5f760a2020202020202020696620656e67696e652e5f72206973206e6f74204e6f6e653a0a202020202020202020202020736176655f646963745b2272225d203d20656e67696e652e5f720a20202020202020200a20202020202020206e702e736176657a5f636f6d7072657373656428706174682c202a2a736176655f64696374290a202020202020202072657475726e207b226e6f646573223a206c656e28656e67696e652e5f696e6465785f746f5f6964297d0a202020200a20202020646566206c6f61645f6e707a2873656c662c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a20202020202020202222224e756d507920ec9595ecb69520ed8c8cec9dbcec9790ec849c20eab7b8eb9e98ed9484ec998020eb9eaded81ac20ebb2a1ed84b020eba19ceb939c0a20202020202020200a2020202020202020417267733a0a202020202020202020202020706174683a20ed8c8cec9dbc20eab2bdeba19c20282e6e707a290a2020202020202020202020200a202020202020202052657475726e733a0a2020202020202020202020207b226e6f646573223a20eb85b8eb939c20ec88987d0a20202020202020202222220a2020202020202020656e67696e65203d2073656c662e656e67696e650a202020202020202064617461203d206e702e6c6f616428706174682c20616c6c6f775f7069636b6c653d46616c7365290a20202020202020200a20202020202020202320eb85b8eb939c20ebaaa9eba19d20ebb3b5ec9b900a20202020202020206e6f6465735f6a736f6e203d2073747228646174615b226e6f6465735f6a736f6e225d5b305d290a20202020202020206e6f646573203d206a736f6e2e6c6f616473286e6f6465735f6a736f6e290a20202020202020200a2020202020202020656e67696e652e5f696e6465785f746f5f6964203d206e6f6465730a2020202020202020656e67696e652e5f69645f746f5f696e646578203d207b6e69643a206920666f7220692c206e696420696e20656e756d6572617465286e6f646573297d0a20202020202020200a20202020202020202320ed9689eba0ac2febb2a1ed84b020ebb3b5ec9b900a2020202020202020656e67696e652e5f4d203d20646174615b224d225d20696620224d2220696e206461746120656c7365204e6f6e650a2020202020202020656e67696e652e5f76203d20646174615b2276225d2069662022762220696e206461746120656c7365204e6f6e650a2020202020202020656e67696e652e5f72203d20646174615b2272225d2069662022722220696e206461746120656c7365204e6f6e650a20202020202020200a202020202020202072657475726e207b226e6f646573223a206c656e286e6f646573297d0a0a0a23202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a2320ec9794eca78420ed9995ec9ea520eba994ec849ceb939c20284d6978696e20ec8aa4ed8380ec9dbc290a23202d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d0a64656620736176655f746f5f6a736f6e28656e67696e653a20224d656d6f727952616e6b456e67696e65222c20706174683a207374722c20696e64656e743a20696e74203d203229202d3e20446963745b7374722c20696e745d3a0a202020202222224d656d6f727952616e6b456e67696e65ec9d9820ed8eb8ec9d9820eba994ec849ceb939c2222220a2020202072657475726e204d656d6f727952616e6b50657273697374656e636528656e67696e65292e736176655f6a736f6e28706174682c20696e64656e74290a0a0a646566206c6f61645f66726f6d5f6a736f6e28656e67696e653a20224d656d6f727952616e6b456e67696e65222c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a202020202222224d656d6f727952616e6b456e67696e65ec9d9820ed8eb8ec9d9820eba994ec849ceb939c2222220a2020202072657475726e204d656d6f727952616e6b50657273697374656e636528656e67696e65292e6c6f61645f6a736f6e2870617468290a0a0a64656620736176655f746f5f6e707a28656e67696e653a20224d656d6f727952616e6b456e67696e65222c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a202020202222224d656d6f727952616e6b456e67696e65ec9d9820ed8eb8ec9d9820eba994ec849ceb939c2222220a2020202072657475726e204d656d6f727952616e6b50657273697374656e636528656e67696e65292e736176655f6e707a2870617468290a0a0a646566206c6f61645f66726f6d5f6e707a28656e67696e653a20224d656d6f727952616e6b456e67696e65222c20706174683a2073747229202d3e20446963745b7374722c20696e745d3a0a202020202222224d656d6f727952616e6b456e67696e65ec9d9820ed8eb8ec9d9820eba994ec849ceb939c2222220a2020202072657475726e204d656d6f727952616e6b50657273697374656e636528656e67696e65292e6c6f61645f6e707a2870617468290a",
      "raw_text": "\"\"\"MemoryRank Persistence Layer v1.0\n\n영속성 레이어 - 기억 그래프와 랭크 벡터를 영구 저장합니다.\n지원 포맷: JSON, NumPy (.npz)\n\n이 레이어가 있어야 \"장기 기억\"이라는 표현이 정확해집니다.\n- 학습된 기억 중요도가 영구 보존됨\n- 그래프 구조가 프로세스 종료 후에도 유지됨\n\"\"\"\n\nfrom __future__ import annotations\n\nimport json\nfrom pathlib import Path\nfrom typing import TYPE_CHECKING, Dict, List, Tuple, Optional, Any\n\nimport numpy as np\n\nif TYPE_CHECKING:\n    from .memoryrank_engine import MemoryRankEngine, MemoryNodeAttributes\n\n\nclass MemoryRankPersistence:\n    \"\"\"MemoryRank 엔진의 영속성 관리자\n    \n    사용 예시:\n        >>> engine = MemoryRankEngine()\n        >>> engine.build_graph(edges, attributes)\n        >>> engine.calculate_importance()\n        >>> \n        >>> # 저장\n        >>> persistence = MemoryRankPersistence(engine)\n        >>> persistence.save_json(\"memory_graph.json\")\n        >>> \n        >>> # 불러오기\n        >>> new_engine = MemoryRankEngine()\n        >>> persistence = MemoryRankPersistence(new_engine)\n        >>> persistence.load_json(\"memory_graph.json\")\n    \"\"\"\n    \n    def __init__(self, engine: \"MemoryRankEngine\"):\n        self.engine = engine\n    \n    # ------------------------------------------------------------------\n    # JSON 저장/로드 (이식성 우선)\n    # ------------------------------------------------------------------\n    def save_json(self, path: str, indent: int = 2) -> Dict[str, int]:\n        \"\"\"그래프와 랭크 벡터를 JSON으로 저장\n        \n        Args:\n            path: 저장 경로\n            indent: JSON 들여쓰기\n            \n        Returns:\n            {\"nodes\": 노드 수, \"edges\": 엣지 수}\n        \"\"\"\n        engine = self.engine\n        \n        # 노드 목록\n        nodes = list(engine._index_to_id)\n        \n        # 전이 행렬에서 엣지 추출\n        edges = []\n        if engine._M is not None:\n            n = engine._M.shape[0]\n            for j in range(n):  # src\n                for i in range(n):  # dst\n                    weight = engine._M[i, j]\n                    if weight > 0:\n                        edges.append({\n                            \"src\": engine._index_to_id[j],\n                            \"dst\": engine._index_to_id[i],\n                            \"weight\": float(weight),\n                        })\n        \n        # personalization vector\n        personalization = None\n        if engine._v is not None:\n            personalization = {\n                nid: float(engine._v[i])\n                for i, nid in enumerate(engine._index_to_id)\n            }\n        \n        # rank vector\n        ranks = None\n        if engine._r is not None:\n            ranks = {\n                nid: float(engine._r[i])\n                for i, nid in enumerate(engine._index_to_id)\n            }\n        \n        data = {\n            \"version\": \"1.0.0\",\n            \"engine\": \"MemoryRankEngine\",\n            \"node_count\": len(nodes),\n            \"edge_count\": len(edges),\n            \"nodes\": nodes,\n            \"edges\": edges,\n            \"personalization\": personalization,\n            \"ranks\": ranks,\n        }\n        \n        Path(path).write_text(json.dumps(data, indent=indent, ensure_ascii=False))\n        return {\"nodes\": len(nodes), \"edges\": len(edges)}\n    \n    def load_json(self, path: str) -> Dict[str, int]:\n        \"\"\"JSON에서 그래프와 랭크 벡터 로드\n        \n        Args:\n            path: 파일 경로\n            \n        Returns:\n            {\"nodes\": 노드 수, \"edges\": 엣지 수}\n        \"\"\"\n        data = json.loads(Path(path).read_text())\n        engine = self.engine\n        \n        nodes = data.get(\"nodes\", [])\n        edges_data = data.get(\"edges\", [])\n        personalization = data.get(\"personalization\")\n        ranks = data.get(\"ranks\")\n        \n        n = len(nodes)\n        \n        # 노드 매핑 복원\n        engine._index_to_id = list(nodes)\n        engine._id_to_index = {nid: i for i, nid in enumerate(nodes)}\n        \n        # 전이 행렬 복원\n        if n > 0:\n            engine._M = np.zeros((n, n), dtype=float)\n            for edge in edges_data:\n                src, dst, w = edge[\"src\"], edge[\"dst\"], edge[\"weight\"]\n                if src in engine._id_to_index and dst in engine._id_to_index:\n                    j = engine._id_to_index[src]\n                    i = engine._id_to_index[dst]\n                    engine._M[i, j] = w\n        else:\n            engine._M = None\n        \n        # personalization vector 복원\n        if personalization and n > 0:\n            engine._v = np.zeros(n, dtype=float)\n            for nid, val in personalization.items():\n                if nid in engine._id_to_index:\n                    engine._v[engine._id_to_index[nid]] = val\n        else:\n            engine._v = np.ones(n, dtype=float) / n if n > 0 else None\n        \n        # rank vector 복원\n        if ranks and n > 0:\n            engine._r = np.zeros(n, dtype=float)\n            for nid, val in ranks.items():\n                if nid in engine._id_to_index:\n                    engine._r[engine._id_to_index[nid]] = val\n        else:\n            engine._r = None\n        \n        return {\"nodes\": n, \"edges\": len(edges_data)}\n    \n    # ------------------------------------------------------------------\n    # NumPy 저장/로드 (성능 우선)\n    # ------------------------------------------------------------------\n    def save_npz(self, path: str) -> Dict[str, int]:\n        \"\"\"그래프와 랭크 벡터를 NumPy 압축 파일로 저장\n        \n        대용량 그래프에 적합 (JSON보다 빠름)\n        \n        Args:\n            path: 저장 경로 (.npz)\n            \n        Returns:\n            {\"nodes\": 노드 수}\n        \"\"\"\n        engine = self.engine\n        \n        # 노드 목록을 JSON 문자열로\n        nodes_json = json.dumps(engine._index_to_id, ensure_ascii=False)\n        \n        save_dict = {\n            \"nodes_json\": np.array([nodes_json]),\n        }\n        \n        if engine._M is not None:\n            save_dict[\"M\"] = engine._M\n        if engine._v is not None:\n            save_dict[\"v\"] = engine._v\n        if engine._r is not None:\n            save_dict[\"r\"] = engine._r\n        \n        np.savez_compressed(path, **save_dict)\n        return {\"nodes\": len(engine._index_to_id)}\n    \n    def load_npz(self, path: str) -> Dict[str, int]:\n        \"\"\"NumPy 압축 파일에서 그래프와 랭크 벡터 로드\n        \n        Args:\n            path: 파일 경로 (.npz)\n            \n        Returns:\n            {\"nodes\": 노드 수}\n        \"\"\"\n        engine = self.engine\n        data = np.load(path, allow_pickle=False)\n        \n        # 노드 목록 복원\n        nodes_json = str(data[\"nodes_json\"][0])\n        nodes = json.loads(nodes_json)\n        \n        engine._index_to_id = nodes\n        engine._id_to_index = {nid: i for i, nid in enumerate(nodes)}\n        \n        # 행렬/벡터 복원\n        engine._M = data[\"M\"] if \"M\" in data else None\n        engine._v = data[\"v\"] if \"v\" in data else None\n        engine._r = data[\"r\"] if \"r\" in data else None\n        \n        return {\"nodes\": len(nodes)}\n\n\n# ------------------------------------------------------------------\n# 엔진 확장 메서드 (Mixin 스타일)\n# ------------------------------------------------------------------\ndef save_to_json(engine: \"MemoryRankEngine\", path: str, indent: int = 2) -> Dict[str, int]:\n    \"\"\"MemoryRankEngine의 편의 메서드\"\"\"\n    return MemoryRankPersistence(engine).save_json(path, indent)\n\n\ndef load_from_json(engine: \"MemoryRankEngine\", path: str) -> Dict[str, int]:\n    \"\"\"MemoryRankEngine의 편의 메서드\"\"\"\n    return MemoryRankPersistence(engine).load_json(path)\n\n\ndef save_to_npz(engine: \"MemoryRankEngine\", path: str) -> Dict[str, int]:\n    \"\"\"MemoryRankEngine의 편의 메서드\"\"\"\n    return MemoryRankPersistence(engine).save_npz(path)\n\n\ndef load_from_npz(engine: \"MemoryRankEngine\", path: str) -> Dict[str, int]:\n    \"\"\"MemoryRankEngine의 편의 메서드\"\"\"\n    return MemoryRankPersistence(engine).load_npz(path)\n"
    },
    "previous_hash": "0",
    "hash": "1ddac002f1b4b79e40a60300ccfb0c6487d7c5aec3a3702e6ab7f2d141ca100b"
  }
]